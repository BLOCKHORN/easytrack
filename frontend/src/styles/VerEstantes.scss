/* ==========================================================================
   VerEstantes.scss — Simetría total y responsive sin cortes
   ========================================================================== */

.ver-estantes {
  /* tokens */
  --surface:     #ffffff;
  --surface-2:   #f8fafc;
  --surface-3:   #eef2f7;
  --elev:        #0f172a;
  --text:        #0b1220;
  --muted:       #5b6b88;
  --border:      #e6ebf2;
  --border-2:    #dfe6f1;

  --brand:       #2563eb;
  --brand-rgba:  rgba(37,99,235,.14);
  --brand-ring:  rgba(37,99,235,.36);

  --success:     #16a34a;
  --warning:     #f59e0b;
  --danger-700:  #b91c1c;

  --radius-lg:   16px;
  --radius-md:   12px;
  --radius-sm:   10px;

  --control-h:   44px;
  --gap:         12px;

  /* controles de card/acciones (para simetría) */
  --card-pad:    12px; /* padding base del card */
  --actions-w:   96px; /* colchón derecho reservado a acciones */
  --action-btn:  34px; /* tamaño de cada icon-btn */

  color: var(--text);
  background: var(--surface);
  padding: clamp(16px, 2vw, 28px);
  padding-bottom: clamp(24px, env(safe-area-inset-bottom) + 72px, 96px);

  &,
  *,
  *::before,
  *::after { min-width: 0; box-sizing: border-box; }

  /* Oculta posibles FABs heredados */
  .fab-delete,
  .delete-fab,
  .btn-delete-fixed,
  .floating-delete,
  .paquete-delete-fab { display: none !important; }

  /* ===== CABECERA ===== */
  .titulo-bar {
    border: 1px solid var(--border);
    border-radius: calc(var(--radius-lg) + 2px);
    background: linear-gradient(180deg, var(--surface-2), var(--surface));
    box-shadow: 0 10px 28px rgba(13,34,79,.06), inset 0 1px 0 rgba(255,255,255,.55);
    padding: clamp(14px, 1.6vw, 18px);

    h2 {
      margin: 0;
      display: inline-flex; align-items: center; gap: 10px;
      font-size: clamp(22px, 2.4vw, 28px);
      font-weight: 900; letter-spacing: -0.015em; line-height: 1.1;
      color: var(--elev);
      .icono { color: var(--brand); filter: drop-shadow(0 2px 5px rgba(37,99,235,.25)); }
    }
  }

  /* ===== TOOLBAR ===== */
  .toolbar {
    margin-top: 14px;
    display: grid;
    gap: 12px;

    .leyenda {
      display: flex; flex-wrap: wrap; gap: 10px 14px; align-items: center;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 8px 10px;
      box-shadow: 0 4px 12px rgba(2,6,23,.04);

      .leg-item { display: inline-flex; align-items: center; gap: 8px; color: var(--muted); font-weight: 800; font-size: 12px; }
      .dot { width: 12px; height: 12px; border-radius: 50%; box-shadow: inset 0 0 0 2px rgba(255,255,255,.6), 0 0 0 1px rgba(2,6,23,.06); }
      .dot.neutra{ background:#94a3b8; } .dot.verde{ background:#22c55e; }
      .dot.naranja{ background:#f59e0b; } .dot.rojo{ background:#ef4444; }
    }

    .filtros {
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      gap: 12px; align-items: center;

      @media (max-width: 1024px) {
        grid-template-columns: 1fr auto auto;
      }
      @media (max-width: 640px) {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .input-icon {
        height: var(--control-h);
        display: flex; align-items: center; gap: 8px;
        border: 1px solid var(--border); border-radius: var(--radius-md);
        padding: 0 12px; background: var(--surface);
        box-shadow: 0 4px 12px rgba(2,6,23,.04);
        svg { color: var(--muted); flex: 0 0 auto; }
        input { flex: 1 1 auto; height: 100%; border: 0; outline: 0; background: transparent; color: var(--elev); font-size: 15px; min-width: 0; }
        input::placeholder { color: #9aa6bf; }
        &:focus-within { box-shadow: 0 0 0 3px var(--brand-ring); border-color: #cfe0ff; }
        .clear { border: 0; background: transparent; color: var(--muted); padding: 6px; border-radius: 8px; cursor: pointer; }
        .clear:hover { background: var(--surface-2); color: var(--elev); }
      }

      .toggle {
        display: inline-flex; align-items: center; gap: 10px; user-select: none;
        .label { color: var(--muted); font-weight: 800; white-space: nowrap; }
        input { display: none; }
        .slider {
          width: 52px; height: 28px; border-radius: 999px; background: var(--surface-2); border: 1px solid var(--border);
          position: relative; transition: background .15s, border-color .15s;
        }
        .slider::after {
          content:''; position: absolute; top: 3px; left: 3px; width: 22px; height: 22px; border-radius: 50%;
          background: #fff; border: 1px solid var(--border); box-shadow: 0 2px 6px rgba(2,6,23,.12);
          transition: transform .18s ease;
        }
        input:checked + .slider { background: var(--brand-rgba); border-color: color-mix(in srgb, var(--brand) 36%, #fff); }
        input:checked + .slider::after { transform: translateX(24px); }
      }

      .btn-ghost {
        height: var(--control-h); padding: 0 12px; border-radius: var(--radius-md);
        border: 1px solid var(--border); background: var(--surface-2); color: var(--elev); font-weight: 900; cursor: pointer;
        display: inline-flex; align-items: center; gap: 8px; white-space: nowrap;
        transition: background .15s, transform .05s, box-shadow .15s, border-color .15s;
      }
      .btn-ghost:hover { background: var(--surface-3); border-color: #d5e3ff; }
      .btn-ghost:focus-visible { outline: none; box-shadow: 0 0 0 4px var(--brand-ring); }

      .acciones { display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap; }
      @media (max-width: 640px) {
        .acciones { justify-content: stretch; }
        .acciones .btn-ghost { width: 100%; }
      }
    }
  }

  /* ===== ESTADOS ===== */
  .skeleton { margin-top: 16px; display: grid; gap: 12px; }
  .skeleton .row { height: 66px; border-radius: var(--radius-md); border: 1px solid var(--border); background: linear-gradient(90deg, var(--surface-2), var(--surface-3), var(--surface-2)); background-size: 180px 100%; animation: bpShimmer 1.1s linear infinite; }
  @keyframes bpShimmer { from { background-position: -180px 0 } to { background-position: 180px 0 } }

  .estado-error, .estado-vacio {
    margin-top: 16px; padding: 18px; border: 1px dashed var(--border); border-radius: var(--radius-md);
    background: var(--surface-2); color: var(--muted);
  }

  /* ===== GRID ===== */
  .fit-wrapper { width: 100%; overflow: visible; }

  .lanes-matrix {
    --cols: 1;
    margin-top: 14px;
    display: grid;
    gap: var(--gap);
    grid-auto-rows: auto;
    grid-template-columns: repeat(var(--cols, 1), minmax(0, 1fr));
    width: 100%;
  }
  @media (max-width: 1024px) {
    .lanes-matrix { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
  }
  @media (max-width: 640px) {
    .lanes-matrix { grid-template-columns: 1fr !important; gap: 10px; }
  }

  .lane-cell {
    min-width: 0;
    &.wrap { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); box-shadow: 0 8px 24px rgba(13,34,79,.06); overflow: hidden; transition: box-shadow .18s, border-color .18s; }
    &.wrap:hover { border-color: #d5e3ff; box-shadow: 0 12px 32px rgba(13,34,79,.08); }
    &.activa { box-shadow: 0 12px 36px rgba(13,34,79,.10); }
    &.empty { border: 1px dashed var(--border-2); border-radius: var(--radius-md); background: var(--surface-2); }
  }

  .lane-head {
    --occ:#94a3b8; --occ-14: color-mix(in srgb, var(--occ) 14%, #fff); --occ-35: color-mix(in srgb, var(--occ) 35%, #000);
    position: relative; width: 100%;
    display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 10px;
    background: linear-gradient(180deg, var(--surface), var(--occ-14));
    padding: 14px; border: 0; cursor: pointer; text-align: left;

    .lane-tape { position: absolute; left: 0; right: 0; top: 0; height: 6px; background: linear-gradient(90deg, var(--occ), color-mix(in srgb, var(--occ) 50%, #fff)); }
    &::after { content:''; position: absolute; inset: 0; border-radius: inherit; box-shadow: inset 0 0 0 2px var(--occ-35); pointer-events: none; }
    &:hover { box-shadow: 0 0 0 4px var(--brand-ring) inset; }

    .lane-title { font-weight: 900; color: var(--elev); font-size: 16px; min-width: 0; }
    .lane-title mark { background: color-mix(in srgb, var(--brand) 18%, #fff); border-radius: 4px; padding: 0 2px; }

    .lane-qty { justify-self: end; display: inline-grid; gap: 2px; text-align: right; }
    .lane-qty b { font-size: 18px; font-weight: 900; color: var(--elev); }
    .lane-qty i { font-size: 11px; font-style: normal; color: var(--muted); font-weight: 700; }
    .lane-qty.zero b { color: #94a3b8; }

    .chev { color: var(--muted); transition: transform .2s ease; }
    .chev.rot { transform: rotate(180deg); }
  }
  @media (max-width: 640px) {
    .lane-head { padding: 12px; grid-template-columns: 1fr auto auto; }
    .lane-head .lane-title { font-size: 15px; }
    .lane-head .lane-qty b { font-size: 16px; }
  }

  /* ==== visor colapsable ==== */
  .lane-visor {
    overflow: hidden;
    padding: 0 14px 12px;
    max-height: 0;
    opacity: 0;
    transition: max-height .28s ease, opacity .18s ease;
  }
  .lane-cell.open .lane-visor {
    max-height: 3000px;
    opacity: 1;
  }
  @media (max-width: 640px) {
    .lane-visor { padding: 0 12px 10px; }
  }

  /* ===== LISTA DE PAQUETES ===== */
  .lista-paquetes {
    --actions-w: var(--actions-w);
    margin: 10px 0 0; padding: 0; list-style: none; display: grid; gap: 10px;
  }

  .lista-paquetes .paquete {
    position: relative;                 /* anclaje acciones */
    overflow: hidden;                   /* respeta radios sin sobresalir */
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--surface);
    padding: var(--card-pad) calc(var(--actions-w) + var(--card-pad)) var(--card-pad) var(--card-pad);
    display: grid;
    gap: 8px;
    transition: border-color .15s, background .15s, box-shadow .15s;
  }
  .lista-paquetes .paquete:hover {
    border-color: #d5e3ff; background: #fbfdff; box-shadow: 0 10px 24px rgba(13,34,79,.06);
  }

  @media (max-width: 1024px) {
    :root & { --actions-w: 88px; --action-btn: 32px; }
  }
  @media (max-width: 640px) {
    :root & { --actions-w: 80px; --action-btn: 30px; --card-pad: 10px; }
    .lista-paquetes { gap: 8px; }
  }

  .lista-paquetes .cliente { font-weight: 900; color: var(--elev); word-break: break-word; }
  .lista-paquetes .cliente mark { background: #fff2b3; border-radius: 4px; padding: 0 2px; }
  .lista-paquetes .meta { display: flex; gap: 8px; flex-wrap: wrap; }

  .pill { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); background: var(--surface-2); color: var(--elev); font-weight: 800; font-size: 12.5px; }
  .pill.estado.warn { background: color-mix(in srgb, var(--warning) 16%, #fff); border-color: color-mix(in srgb, var(--warning) 30%, #fff); color: color-mix(in srgb, var(--warning) 55%, #000); }
  .pill--carrier { --comp: var(--brand); --comp-rgba: var(--brand-rgba); background: var(--comp-rgba); border-color: color-mix(in srgb, var(--comp) 36%, #fff); color: color-mix(in srgb, var(--comp) 88%, #000); }
  .pill--carrier .dot { width: 10px; height: 10px; border-radius: 50%; background: var(--comp); box-shadow: 0 0 0 2px color-mix(in srgb, var(--comp) 40%, #fff); }

  /* Acciones — SIEMPRE dentro y con margen simétrico */
  .row-actions {
    position: absolute;
    inset-block-start: 12px;
    inset-inline-end: 12px;
    display: inline-flex;
    flex-wrap: nowrap;
    gap: 8px;
    margin: 0;
    z-index: 1;
    pointer-events: auto;
  }
  .icon-btn {
    width: var(--action-btn);
    height: var(--action-btn);
    border-radius: 10px;
    border: 1px solid var(--border);
    background: var(--surface-2);
    color: var(--elev);
    display: inline-flex; align-items: center; justify-content: center;
    cursor: pointer;
    transition: background .15s, color .15s, transform .05s, box-shadow .15s, border-color .15s;
  }
  .icon-btn > svg { width: 18px; height: 18px; color: currentColor !important; fill: currentColor !important; stroke: currentColor !important; pointer-events: none; }
  .icon-btn:hover { background: var(--surface-3); border-color: #d5e3ff; }
  .icon-btn:focus-visible { outline: none; box-shadow: 0 0 0 4px var(--brand-ring); }
  .icon-btn.danger { color: var(--danger-700); background: #fee2e2; border-color: #fecaca; }
  .icon-btn.danger:hover { background: #fecaca; color: var(--danger-700); }

  .blurred { filter: blur(6px); transition: filter .15s ease; user-select: none; }

  /* ==== Ocupación (colores) ==== */
  .lane-head.neutra { --occ: #94a3b8; }
  .lane-head.verde  { --occ: #22c55e; }
  .lane-head.naranja{ --occ: #f59e0b; }
  .lane-head.rojo   { --occ: #ef4444; }
}
