/* ==========================================================================
   BuscarPaquete.scss — armonía de tamaños + acciones pro + parallax suave
   ========================================================================== */

.buscar-paquete {
  /* ---------- Design tokens ---------- */
  --surface:     var(--ep-surface, #ffffff);
  --surface-2:   var(--ep-surface-2, #f8fafc);
  --surface-3:   var(--ep-surface-3, #f1f5f9);
  --elev:        var(--ep-elev, #0f172a);
  --border:      var(--ep-border, #e5e7eb);
  --border-2:    var(--ep-border-2, #e2e8f0);
  --text:        var(--ep-text, #0b1220);
  --muted:       var(--ep-muted, #475569);
  --brand:       var(--ep-brand, #2563eb);
  --brand-rgba:  rgba(37, 99, 235, .14);
  --brand-ring:  rgba(37, 99, 235, .36);
  --success:     #16a34a;
  --danger:      #ef4444;
  --warning:     #f59e0b;
  --info:        #2563eb;

  --radius-lg:   16px;
  --radius-md:   12px;
  --radius-sm:   10px;

  --control-h:   44px;  /* altura homogénea de todos los controles */
  --gap:         12px;  /* módulo base de separación */

  --bp-m:        600px;
  --bp-t:        900px;
  --bp-l:        1200px;

  color: var(--text);
  background: var(--surface);
  padding: clamp(16px, 2vw, 28px);
  position: relative;
  isolation: isolate;
  overflow: visible;

  /* ================= HERO / TÍTULO ================= */
  .titulo-flex {
    position: relative;
    padding: clamp(16px, 1.8vw, 24px);
    border: 1px solid var(--border);
    border-radius: calc(var(--radius-lg) + 2px);
    background:
      radial-gradient(1000px 220px at 8% -16%, color-mix(in srgb, var(--brand) 16%, #fff), transparent 60%),
      radial-gradient(900px 200px at 92% -12%, color-mix(in srgb, var(--brand) 12%, #fff), transparent 55%),
      linear-gradient(180deg, var(--surface-2), var(--surface));
    box-shadow: 0 10px 30px rgba(2,6,23,.06), inset 0 1px 0 rgba(255,255,255,.55);

    display: grid;
    grid-template-columns: 1fr auto;
    align-items: center;
    gap: 14px;

    &::before,
    &::after {
      content: '';
      position: absolute;
      inset: auto;
      border-radius: 999px;
      filter: blur(28px);
      opacity: .55;
      z-index: -1;
      background: radial-gradient(ellipse at center, var(--brand) 0%, transparent 60%);
      animation: bpFloat 14s ease-in-out infinite alternate;
      pointer-events: none;
    }
    &::before { width: clamp(140px, 18vw, 260px); height: clamp(80px, 12vw, 160px); left: -3%; top: -18px; }
    &::after  { width: clamp(120px, 16vw, 220px); height: clamp(70px, 10vw, 140px); right: -3%; top: -24px; animation-duration: 16s; animation-delay: .5s; }

    h2 {
      margin: 0;
      display: inline-flex;
      align-items: center;
      gap: 10px;

      font-size: clamp(24px, 3.2vw, 36px);
      font-weight: 900;
      letter-spacing: -0.015em;
      line-height: 1.1;

      background: linear-gradient(90deg, var(--elev), color-mix(in srgb, var(--brand) 28%, var(--elev)));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      padding-bottom: 8px;
      position: relative;

      .icono-titulo { color: var(--brand); filter: drop-shadow(0 2px 6px rgba(37,99,235,.25)); }

      &::after {
        content:'';
        position:absolute; left:0; bottom:0;
        width: 52%; height: 3px; border-radius: 3px;
        background: linear-gradient(90deg, var(--brand), transparent 85%);
      }
    }

    .kpis {
      display: grid;
      grid-auto-flow: column;
      gap: 10px;

      .kpi {
        min-width: 110px;
        background: var(--surface-2);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        padding: 10px 14px;
        text-align: center;
        display: grid; gap: 2px;

        .kpi-label { color: var(--muted); font-size: 12px; font-weight: 700; }
        .kpi-value { color: var(--elev); font-weight: 900; font-size: 18px; }
      }

      .progress {
        position: relative;
        height: 38px;
        padding: 0 12px;
        border: 1px solid var(--border);
        border-radius: 999px;
        background: linear-gradient(180deg, var(--surface), var(--surface-2));
        display: flex; align-items: center; overflow: hidden;

        .bar { position:absolute; inset: 0 auto 0 0; background: linear-gradient(90deg, color-mix(in srgb, var(--brand) 85%, #fff), var(--brand)); transition: width .35s ease; }
        .progress-text { margin-left: auto; color: var(--muted); font-weight: 700; font-size: 12px; position: relative; z-index: 1; }
      }
    }

    @media (max-width: 980px) {
      grid-template-columns: 1fr;
      .kpis { grid-auto-flow: row; grid-template-columns: repeat(2, minmax(0,1fr)); }
      .kpis .progress { grid-column: 1 / -1; }
    }
  }

  @keyframes bpFloat { from { transform: translate3d(0,0,0) } to { transform: translate3d(0, 12px, 0) } }
  @media (prefers-reduced-motion: reduce) { .titulo-flex::before, .titulo-flex::after { animation: none } }

  /* ================= FILTROS ================= */
  .filtros-superiores {
    margin-top: 14px;
    display: grid;
    grid-template-columns: 1.4fr auto auto auto auto;
    gap: var(--gap);
    align-items: center;
    position: relative;
    z-index: 2;
    overflow: visible;

    @media (max-width: 1200px) { grid-template-columns: 1fr 1fr 1fr; }
    @media (max-width: 720px)  { grid-template-columns: 1fr; }

    .searchbox {
      grid-column: 1 / span 1;
      position: relative;
      display: flex; align-items: center;
      height: var(--control-h);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      background: var(--surface);
      padding: 0 12px;
      box-shadow: 0 4px 12px rgba(2,6,23,.04);
      transition: box-shadow .2s ease, border-color .2s ease;

      &:focus-within { border-color: var(--brand); box-shadow: 0 6px 18px rgba(2,6,23,.06), 0 0 0 4px var(--brand-ring); }

      .magnifier { color: var(--muted); margin-right: 8px; flex: 0 0 auto; }
      input[type="search"] {
        flex: 1 1 auto; height: 100%;
        border: 0; outline: 0; background: transparent;
        font-size: 15px; color: var(--elev);
        &::placeholder { color: color-mix(in srgb, var(--muted) 55%, #fff); }
      }
      .clear {
        border: 0; background: transparent; color: var(--muted); cursor: pointer; padding: 6px; border-radius: 8px;
        &:hover { background: var(--surface-2); color: var(--elev); }
      }

      .suggestions {
        position: absolute; left: 0; right: 0; top: calc(100% + 6px);
        background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-md);
        box-shadow: 0 12px 36px rgba(2,6,23,.12); padding: 6px; list-style: none; margin: 0;
        max-height: 320px; overflow: auto; z-index: 50;
        li { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 10px; color: var(--elev); cursor: pointer; }
        li:hover { background: var(--surface-2); }
        li svg { color: var(--brand); opacity: .9; }
      }
    }

    .segmented {
      display: contents;

      &__label {
        height: var(--control-h);
        display: inline-flex; align-items: center; gap: 8px;
        padding: 0 12px; border: 1px solid var(--border); border-radius: var(--radius-md);
        background: var(--surface); color: var(--elev); font-weight: 800;
      }
      &__group {
        height: var(--control-h);
        display: inline-flex; align-items: center; gap: 4px;
        border: 1px solid var(--border); border-radius: 999px; padding: 4px; background: var(--surface);
        button {
          height: calc(var(--control-h) - 8px);
          border: 0; background: transparent; color: var(--muted); font-weight: 800; padding: 0 12px; border-radius: 999px; cursor: pointer;
          transition: background .15s, color .15s, box-shadow .15s;
          &.active { background: var(--brand-rgba); color: color-mix(in srgb, var(--brand) 88%, #000); box-shadow: 0 2px 8px rgba(37,99,235,.18) inset; }
          &:focus-visible { outline: none; box-shadow: 0 0 0 3px var(--brand-ring); }
        }
      }
    }

    select {
      height: var(--control-h);
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--elev);
      padding: 0 12px;
      font-weight: 700;
      cursor: pointer;
      transition: border-color .15s, box-shadow .15s;
      &:focus { border-color: var(--brand); box-shadow: 0 0 0 4px var(--brand-ring); outline: none; }
    }
  }

  /* ================= CHIPS ================= */
  .chips {
    margin-top: 10px;
    display: flex; align-items: center; flex-wrap: wrap; gap: 12px;

    .chips-label { display: inline-flex; align-items: center; gap: 8px; color: var(--muted); font-weight: 800; }
    .chips-list  { display: flex; flex-wrap: wrap; gap: 10px; }

    .chip {
      --chip-bg: var(--surface-2);
      --chip-bd: var(--border);
      --chip-tx: var(--elev);
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border: 1px solid var(--chip-bd); border-radius: 999px; background: var(--chip-bg); color: var(--chip-tx);
      font-weight: 800; cursor: pointer; transition: transform .05s, background .15s, border-color .15s;
      &:active { transform: translateY(1px) scale(.99); }
      &:hover  { background: var(--surface-3); }
      &.chip--brand { --chip-bg: var(--chip-rgba, rgba(37,99,235,.12)); --chip-bd: color-mix(in srgb, var(--chip, var(--brand)) 36%, #fff); --chip-tx: color-mix(in srgb, var(--chip, var(--brand)) 85%, #000); }
      &.clear-all { background: linear-gradient(180deg, var(--surface), var(--surface-2)); }
    }
  }

  /* ================= ESTADOS ================= */
  .estado-cargando { margin-top: 16px; display: grid; gap: 12px; }
  .estado-cargando .skeleton-row { height: 54px; border: 1px solid var(--border); border-radius: var(--radius-md); background: linear-gradient(90deg, var(--surface-2), var(--surface-3), var(--surface-2)); animation: bpShimmer 1.1s linear infinite; }
  @keyframes bpShimmer { from { background-position: -180px 0 } to { background-position: 180px 0 } }

  .estado-error,
  .estado-vacio {
    margin-top: 16px; padding: 18px;
    border: 1px dashed var(--border); border-radius: var(--radius-md); background: var(--surface-2);
    color: var(--muted); display: grid; gap: 12px;
    .empty-actions { display: flex; flex-wrap: wrap; gap: 10px; }
    .empty-actions button { border: 1px solid var(--border); background: var(--surface); color: var(--elev); border-radius: 10px; padding: 8px 12px; font-weight: 800; cursor: pointer; }
    .empty-actions button:hover { background: var(--surface-3); }
  }

  /* ================= TABLA / CARDS ================= */
  .tabla-wrapper {
    margin-top: 16px; position: relative; z-index: 1; overflow: visible;

    .tabla-paquetes {
      width: 100%;
      border-collapse: separate; border-spacing: 0;
      border: 1px solid var(--border); border-radius: var(--radius-lg);
      background: var(--surface);
      box-shadow: 0 8px 24px rgba(2,6,23,.06);
      table-layout: auto;

      thead {
        position: sticky; top: 0; z-index: 3;
        background: linear-gradient(180deg, var(--surface-2), var(--surface));
        box-shadow: 0 1px 0 var(--border);
        th {
          padding: 14px; text-align: left;
          font-size: 12px; text-transform: uppercase; letter-spacing: .06em; color: var(--muted);
          user-select: none; cursor: default;
          &.asc::after, &.desc::after { content:''; display:inline-block; width:8px; height:8px; margin-left:8px; border-right:2px solid var(--muted); border-bottom:2px solid var(--muted); transform: rotate(-45deg) translateY(-2px); }
          &.desc::after { transform: rotate(135deg) translateY(2px); }
        }
      }

      tbody {
        tr { transition: background .15s ease; }
        tr.lane-tinted { background: var(--lane-rgba, transparent); }
        tr:hover { background: color-mix(in srgb, var(--brand-rgba) 34%, transparent); }

        td {
          padding: 16px 14px;
          border-top: 1px solid var(--border-2);
          vertical-align: middle;

          &.cliente { font-weight: 800; color: var(--elev); }
          &.cliente mark { background: color-mix(in srgb, var(--brand) 18%, #fff); padding: 0 2px; border-radius: 4px; }

          .comp-chip {
            --comp-bg: var(--comp-rgba, rgba(37,99,235,.12));
            --comp-bd: color-mix(in srgb, var(--comp, var(--brand)) 40%, #fff);
            --comp-tx: color-mix(in srgb, var(--comp, var(--brand)) 85%, #000);
            display: inline-flex; align-items: center; gap: 8px;
            padding: 6px 10px;
            border: 1px solid var(--comp-bd);
            border-radius: 999px;
            background: var(--comp-bg);
            color: var(--comp-tx);
            font-weight: 900;
            .comp-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--comp, var(--brand)); box-shadow: 0 0 0 2px color-mix(in srgb, var(--comp, var(--brand)) 40%, #fff); }
          }

          .ubi {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 6px 10px; border-radius: 999px;
            background: var(--surface-2); border: 1px solid var(--border);
            font-weight: 800;
            &.lane {
              --lane-dot: var(--lane, var(--brand));
              background: var(--lane-rgba, var(--surface-2));
              border-color: color-mix(in srgb, var(--lane-dot) 40%, #fff);
              .lane-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--lane-dot); box-shadow: 0 0 0 2px color-mix(in srgb, var(--lane-dot) 40%, #fff); }
            }
          }

          .badge-estado {
            display: inline-flex; align-items: center; border-radius: 999px; padding: 6px 10px; font-size: 12px; font-weight: 900;
            &.pendiente { background: color-mix(in srgb, var(--warning) 16%, #fff); color: color-mix(in srgb, var(--warning) 55%, #000); border: 1px solid color-mix(in srgb, var(--warning) 30%, #fff); }
            &.entregado { background: color-mix(in srgb, var(--success) 16%, #fff); color: color-mix(in srgb, var(--success) 55%, #000); border: 1px solid color-mix(in srgb, var(--success) 30%, #fff); }
          }

          /* ======== ACCIONES (alineadas EN LÍNEA, carácter pro) ======== */
          &.acciones {
            white-space: nowrap; /* evita salto a columna */
            padding-right: 16px;

            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 10px;

            .icono {
              --accent: var(--muted);
              --accent-bg: var(--surface-2);
              --accent-bd: var(--border);
              --accent-fg: var(--elev);

              width: 40px; height: 40px;
              display: grid; place-items: center;
              border-radius: 12px;
              border: 1px solid var(--accent-bd);
              background: var(--accent-bg);
              color: var(--accent-fg);
              cursor: pointer;
              transition: transform .05s ease, background .15s ease, color .15s ease, border-color .15s ease, box-shadow .15s ease;

              /* micro elevación */
              &:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(2,6,23,.08); }
              &:active { transform: translateY(0); box-shadow: none; }

              /* variantes */
              &.editar   { --accent: var(--brand);  --accent-bg: color-mix(in srgb, var(--brand) 10%, #fff); --accent-bd: color-mix(in srgb, var(--brand) 35%, #fff); --accent-fg: color-mix(in srgb, var(--brand) 88%, #000); }
              &.entregar { --accent: var(--success); --accent-bg: color-mix(in srgb, var(--success) 12%, #fff); --accent-bd: color-mix(in srgb, var(--success) 35%, #fff); --accent-fg: color-mix(in srgb, var(--success) 88%, #000); }
              &.eliminar { --accent: var(--danger);  --accent-bg: color-mix(in srgb, var(--danger) 10%, #fff);  --accent-bd: color-mix(in srgb, var(--danger) 35%, #fff);  --accent-fg: color-mix(in srgb, var(--danger) 88%, #000); }
            }
          }
        }
      }
    }

    /* Cards móviles (< 900px) */
    .cards-m { display: none; margin-top: 12px; }
    @media (max-width: 900px) {
      .tabla-paquetes { display: none; }
      .cards-m { display: grid; gap: 12px; }
      .cards-m .card {
        border: 1px solid var(--border); border-radius: var(--radius-lg);
        background: var(--surface); padding: 12px; box-shadow: 0 6px 20px rgba(2,6,23,.06);
        &.lane-tinted { background: var(--lane-rgba, var(--surface)); }
        .card__head { display: flex; align-items: center; gap: 12px; }
        .card__title { margin: 0; font-weight: 900; color: var(--elev); }
        .card__row { margin-top: 10px; display: grid; grid-template-columns: 120px 1fr; gap: 12px; }
        .label { color: var(--muted); font-weight: 800; }
        .card__actions { margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap; }
        .btn { border-radius: 10px; padding: 8px 12px; font-weight: 900; border: 1px solid var(--border); background: var(--surface); color: var(--elev); display: inline-flex; align-items: center; gap: 8px; }
        .btn--ghost { background: var(--surface-2); }
        .btn--primary { background: color-mix(in srgb, var(--success) 12%, #fff); border-color: color-mix(in srgb, var(--success) 35%, #fff); color: color-mix(in srgb, var(--success) 88%, #000); }
        .btn--danger-ghost { background: color-mix(in srgb, var(--danger) 8%, #fff); border-color: color-mix(in srgb, var(--danger) 35%, #fff); color: color-mix(in srgb, var(--danger) 80%, #000); }
      }
    }
  }

  /* ================= PAGINACIÓN ================= */
  .paginacion {
    margin-top: 16px; display: flex; align-items: center; justify-content: center; gap: 12px;
    button {
      width: 42px; height: 42px; border-radius: 12px;
      border: 1px solid var(--border); background: var(--surface);
      color: var(--elev); font-weight: 900; cursor: pointer;
      transition: background .15s, transform .05s, box-shadow .15s;
      &:disabled { opacity: .5; cursor: not-allowed; }
      &:hover:not(:disabled) { background: var(--surface-2); }
      &:active:not(:disabled) { transform: translateY(1px) scale(.98); }
      &:focus-visible { outline: none; box-shadow: 0 0 0 4px var(--brand-ring); }
    }
    span { color: var(--muted); font-weight: 800; }
  }

  /* ================= MODAL EDICIÓN ================= */
  .modal-edicion {
    position: fixed; inset: 0; z-index: 120;
    display: grid; place-items: center;
    background: color-mix(in srgb, #0b1220 30%, transparent);

    .modal-contenido {
      width: min(720px, 92vw);
      background: var(--surface);
      border: 1px solid var(--border); border-radius: 18px;
      padding: clamp(16px, 2vw, 22px);
      box-shadow: 0 20px 60px rgba(2,6,23,.25);
      display: grid; gap: 14px;

      h3 { margin: 0 0 4px; font-size: clamp(18px, 2.2vw, 22px); font-weight: 900; color: var(--elev); }

      label { display: grid; gap: 8px; }
      label span { font-weight: 800; color: var(--muted); }
      input, select {
        height: var(--control-h); border-radius: var(--radius-md);
        border: 1px solid var(--border); background: var(--surface); color: var(--elev); padding: 0 12px; font-weight: 700;
      }
      input:focus, select:focus { border-color: var(--brand); box-shadow: 0 0 0 4px var(--brand-ring); outline: none; }

      .modal-acciones { margin-top: 6px; display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap; }
      .guardar  { background: color-mix(in srgb, var(--brand) 12%, #fff); border: 1px solid color-mix(in srgb, var(--brand) 35%, #fff); color: color-mix(in srgb, var(--brand) 88%, #000); padding: 10px 14px; border-radius: var(--radius-md); font-weight: 900; cursor: pointer; }
      .cancelar { background: var(--surface-2); border: 1px solid var(--border); color: var(--elev); padding: 10px 14px; border-radius: var(--radius-md); font-weight: 900; cursor: pointer; }
    }
  }

  /* ================= CONFIRM ================= */
  .bp-confirm {
    position: fixed; inset: 0; z-index: 130; display: grid; place-items: center;
    background: color-mix(in srgb, #0b1220 30%, transparent);

    &__panel {
      width: min(560px, 92vw);
      background: var(--surface); border: 1px solid var(--border); border-radius: 18px;
      padding: clamp(16px, 2vw, 22px); box-shadow: 0 20px 60px rgba(2,6,23,.25);
      display: grid; gap: 12px;
      h4 { margin: 0; font-weight: 900; color: var(--elev); }
      p  { margin: 0; color: var(--muted); }
    }
    &__actions { margin-top: 4px; display: flex; gap: 10px; justify-content: flex-end; }
    .btn { border-radius: var(--radius-md); padding: 10px 14px; font-weight: 900; cursor: pointer; }
    .btn--muted  { border: 1px solid var(--border); background: var(--surface-2); color: var(--elev); }
    .btn--danger { border: 1px solid color-mix(in srgb, var(--danger) 35%, #fff); background: color-mix(in srgb, var(--danger) 12%, #fff); color: color-mix(in srgb, var(--danger) 88%, #000); }
  }

  /* ================= TOASTS (contraste) ================= */
  .toasts {
    position: fixed; right: clamp(10px, 2vw, 24px); bottom: clamp(10px, 2vw, 24px);
    display: grid; gap: 10px; z-index: 160; width: min(92vw, 380px);
    .toast { border-radius: var(--radius-md); padding: 12px 14px; color: #fff; font-weight: 900; box-shadow: 0 12px 30px rgba(2,6,23,.25), inset 0 1px 0 rgba(255,255,255,.22); border: 1px solid rgba(255,255,255,.18); }
    .toast.success { background: linear-gradient(180deg, color-mix(in srgb, var(--success) 90%, #000), var(--success)); }
    .toast.error   { background: linear-gradient(180deg, color-mix(in srgb, var(--danger) 90%, #000), var(--danger)); }
    .toast.info    { background: linear-gradient(180deg, color-mix(in srgb, var(--info) 90%, #000), var(--info)); }
  }

  /* ================= Accesibilidad: focus ================= */
  :where(button, [role="tab"], [role="option"]) { &:focus-visible { outline: none; box-shadow: 0 0 0 4px var(--brand-ring); } }
}
