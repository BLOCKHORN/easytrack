/* src/styles/AnadirPaquete.scss */
/* ===== Tokens ===== */
:root{
  --brand:#2563eb; --brand-rgba:rgba(37,99,235,.12); --brand-ring:rgba(37,99,235,.35);
  --bg:#f7f9fc; --card:#fff; --card-2:#f3f6fb; --text:#0b1426; --muted:#5b6b88; --line:#dfe6f1;
  --ok:#16a34a; --warn:#d97706; --danger:#dc2626;
  --ring:0 0 0 3px var(--brand-ring);
  --shadow-1:0 6px 18px rgba(13,34,79,.10);
  --shadow-2:0 12px 32px rgba(13,34,79,.14);
}

.anadir-paquete{
  color:var(--text); background:var(--bg); min-height:100svh; padding-bottom:56px;

  /* ===== Layout container ===== */
  .cabecera, .form{
    width:min(1180px, 94vw);
    margin-inline:auto;
  }

  /* ===== Header (más aire y sin “corte”) ===== */
  .cabecera{
    padding:28px 0 16px; border-bottom:1px solid var(--line);
    background:
      radial-gradient(1200px 220px at 0% -14%, rgba(37,99,235,.10) 0%, transparent 55%),
      linear-gradient(180deg,#ffffff 0%,#f8fbff 100%);
    display:grid; grid-template-columns:1fr auto; gap:12px; align-items:end;

    .titulo{ display:flex; align-items:center; gap:12px; min-width:0;
      svg{font-size:24px; color:var(--brand);}
      h1{margin:0; font-size:22px; font-weight:800;}
      p{margin:0; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
    }

    /* Tabs Superiores */
    .top-tabs{
      display:flex; gap:10px; align-items:center; justify-content:flex-end;
      padding:8px; background:#fff; border:1px solid var(--line); border-radius:14px;
      box-shadow:0 8px 22px rgba(13,34,79,.06);
      max-width:100%; overflow:auto; scrollbar-gutter:stable both-edges;
    }
    .top-tabs .tab{
      appearance:none; border:none; background:#f3f6fb; color:var(--text);
      font-weight:900; letter-spacing:.01em; padding:10px 16px;
      border-radius:12px; cursor:pointer; white-space:nowrap;
      transition:filter .18s ease, transform .06s ease, background .18s ease, box-shadow .18s ease;
    }
    .top-tabs .tab:hover{ filter:brightness(1.02); transform:translateY(-1px); }
    .top-tabs .tab.active{
      background:var(--brand); color:#fff; box-shadow:0 10px 26px rgba(37,99,235,.25);
    }

    @media (max-width:900px){
      grid-template-columns:1fr;
      .top-tabs{ justify-content:flex-start; }
      .titulo{ align-items:flex-start; flex-direction:column; }
    }
  }

  .form{ padding:18px 0 22px; display:grid; gap:16px; }

  /* ===== Botones ===== */
  .btn-primary{
    background:var(--brand); border:none; color:#fff; font-weight:800; border-radius:14px; cursor:pointer;
    transition:transform .06s ease, filter .18s ease, box-shadow .18s ease; box-shadow:0 10px 28px rgba(37,99,235,.22);
    padding:12px 18px; font-size:15px; letter-spacing:.01em;
  }
  .btn-xl{ padding:16px 24px; font-size:18px; min-width:280px; }
  .btn-primary:hover{ filter:brightness(1.05); transform:translateY(-1px); }
  .btn-primary:focus-visible{ outline:none; box-shadow:var(--ring); }
  .btn-primary:disabled{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }

  .btn-secondary{
    background:#fff; color:#0b1426; border:1px solid var(--line); border-radius:12px; font-weight:800; cursor:pointer;
    padding:10px 14px; display:inline-flex; align-items:center; gap:8px;
    box-shadow:0 6px 18px rgba(13,34,79,.06);
    transition:transform .06s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
  }
  .btn-secondary:hover{ transform:translateY(-1px); border-color:#cfe0ff; background:#f9fbff; }
  .btn-secondary:focus-visible{ outline:none; box-shadow:var(--ring); }
  .btn-secondary:disabled{ opacity:.55; cursor:not-allowed; transform:none; box-shadow:none; }

  /* ===== Panel base ===== */
  .panel{
    background:var(--card); border:1px solid var(--line); border-radius:16px; padding:16px 16px 18px; box-shadow:var(--shadow-1);
    h2{ margin:0 0 6px; font-size:16px; font-weight:800; }
    .hint{ margin:0 0 10px; color:var(--muted); font-size:13px; }
  }

  /* =========================================================
     DATOS DEL PAQUETE
     ========================================================= */
  .panel.datos{
    background:
      linear-gradient(180deg,#ffffff 0%, #ffffff 65%, #ffffff 65%) padding-box,
      radial-gradient(1200px 300px at 50% -80px, rgba(37,99,235,.08), transparent 60%) border-box;

    .fila{
      display:grid; gap:14px; grid-template-columns: 1.4fr 1fr;
      @media (max-width: 980px){ grid-template-columns: 1fr; }
    }

    .campo{
      position:relative; display:flex; flex-direction:column; gap:8px;
      padding:10px 12px; border-radius:12px; background:var(--card-2); border:1px solid var(--line);
      label{ font-size:12px; color:var(--muted); font-weight:700; letter-spacing:.02em; }
      input[type="text"], select{
        width:100%;
        background:#fff; border:1px solid var(--line); color:var(--text);
        padding:12px 12px; border-radius:10px; outline:none; height:44px;
        transition:border-color .18s ease, box-shadow .18s ease, background .18s ease;
      }
      input::placeholder{ color:#94a3b8; }
      input:focus, select:focus{ border-color:var(--brand); box-shadow:var(--ring); }

      /* Sugerencia fuzzy */
      .sugerencia-cliente{
        margin-top:6px; display:flex; flex-wrap:wrap; gap:8px; animation:fadeInUp .18s ease both;
      }
      .suggestion-pill{
        background:linear-gradient(180deg,#f7fbff,#eef4ff); border:1px solid #dbe7ff;
        color:#0b3b8c; border-radius:999px; padding:10px 14px; font-weight:900; font-size:13px;
        cursor:pointer; display:inline-flex; align-items:center; gap:6px;
        box-shadow:0 3px 10px rgba(13,34,79,.06);
        transition:transform .06s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease;
      }
      .suggestion-pill:hover{ transform:translateY(-1px); background:#eaf1ff; border-color:#cfe0ff; }
      .suggestion-pill:focus-visible{ outline:none; box-shadow:var(--ring); }

      .match-hint{ display:block; margin-top:6px; font-style:italic; color:#0b3b8c; font-size:12.5px; }
      .match-hint strong.pulse-constant{ padding:0 4px; border-radius:6px; }
    }

    .bloque-central{
      margin-top:12px; display:grid; gap:14px; place-items:center;

      .chips{
        display:flex; gap:14px; flex-wrap:wrap; justify-content:center; align-items:center;
        background:#fff; border:1px solid var(--line); border-radius:14px; padding:12px 14px;
        box-shadow:0 6px 18px rgba(13,34,79,.06);
      }
      .chips.xl{ gap:16px; }

      .chip{
        display:inline-grid; grid-auto-flow:column; align-items:center; gap:12px;
        padding:12px 14px; border-radius:14px; border:1px solid var(--line); font-weight:700; min-height:74px;
        svg{ font-size:20px; }
        .lbl{ letter-spacing:.02em; color:var(--text); opacity:.9; }
        .pill{
          font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
          font-size:22px; font-weight:800; background:#eef4ff; border:1px solid #d9e6ff;
          padding:8px 14px; border-radius:12px; color:var(--text);
        }
        &.square{
          min-width:280px; min-height:110px; border-radius:16px;
          grid-auto-flow:row; align-content:center; justify-items:center; text-align:center;
          .lbl{ font-size:13px; }
          .pill{ font-size:26px; padding:10px 16px; }
        }
      }
      .chip--hint{ background:linear-gradient(180deg,#fff6e9,#fff0db); border-color:#ffe0b3; svg{color:var(--warn);} }
      .chip--selected{ background:linear-gradient(180deg,#eaf1ff,#e3eeff); border-color:#cfe0ff; svg{color:var(--brand);} }

      .acciones-centro{ display:grid; place-items:center; }

      @media (max-width:640px){
        .chips{ padding:10px 12px; gap:10px; }
        .chip{ gap:10px; padding:10px 12px;
          .pill{ font-size:18px; padding:6px 10px; }
        }
        .btn-xl{ width:100%; min-width:0; font-size:16px; padding:14px 18px; }
        .chip.square{ min-width:unset; width:100%; }
      }
    }
  }

  /* =========================================================
     MODO MÚLTIPLE — Toolbar alineada en desktop
     ========================================================= */
  .panel.multiple{
    background:
      linear-gradient(180deg,#ffffff 0%, #ffffff 65%, #ffffff 65%) padding-box,
      radial-gradient(1200px 300px at 50% -80px, rgba(37,99,235,.08), transparent 60%) border-box;

    .multiple-head{
      display:flex; align-items:flex-end; justify-content:space-between; gap:10px; margin-bottom:10px;
      h2{ display:flex; align-items:center; gap:8px; margin:0; }
      .hint{ margin:0; color:var(--muted); }
    }

    /* Toolbar responsive con 3 zonas: número | checkbox | empresa */
    .multiple-config{
      display:grid; gap:10px; margin-bottom:10px;

      @media (min-width:1024px){
        grid-template-columns: 280px 1fr 320px;
        align-items:end;
        .row{ margin:0; }
        .row:nth-child(1){ grid-column:1; }
        .row:nth-child(2){ grid-column:2 / span 2; display:grid; grid-template-columns:auto 1fr; gap:12px; align-items:center; }
        .row:nth-child(2) .multi-label{ display:none; } /* el texto del checkbox actúa de etiqueta */
        .row:nth-child(2) > .row{ grid-column:2; margin:0; } /* “Empresa para todos” (subfila) a la derecha */
      }

      .row{
        background:#fff; border:1px solid var(--line); border-radius:12px; padding:10px 12px;
        display:grid; gap:8px; box-shadow:0 6px 18px rgba(13,34,79,.04);
        .multi-label{ font-size:13px; font-weight:800; color:#0b1426; }
        .multi-controls{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }

        .multi-number{
          width:100%; max-width:180px; height:44px; border-radius:10px; border:1px solid var(--line); padding:8px 10px; font-weight:800;
          background:#fff; color:#0b1426; outline:none; transition:border-color .18s ease, box-shadow .18s ease;
        }
        .multi-number:focus{ border-color:var(--brand); box-shadow:var(--ring); }
        .multi-number::-webkit-outer-spin-button,
        .multi-number::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
        .multi-number{ -moz-appearance:textfield; }

        .multi-check{
          display:flex; align-items:center; gap:10px; font-weight:800; color:#0b1426;
          input[type="checkbox"]{ width:18px; height:18px; accent-color:var(--brand); }
        }

        .multi-select{
          height:44px; border-radius:10px; border:1px solid var(--line); background:#fff; padding:10px 12px;
          outline:none; transition:border-color .18s ease, box-shadow .18s ease; min-width:220px;
        }
        .multi-select:focus{ border-color:var(--brand); box-shadow:var(--ring); }
      }
    }

    /* Chips Sugerencia/Seleccionado (comparten estilos con single) */
    .bloque-central{
      margin-top:6px;
      .chips{
        display:flex; gap:14px; flex-wrap:wrap; justify-content:center; align-items:center;
        background:#fff; border:1px solid var(--line); border-radius:14px; padding:12px 14px;
        box-shadow:0 6px 18px rgba(13,34,79,.06);
      }
      .chip{
        display:inline-grid; grid-auto-flow:column; align-items:center; gap:12px;
        padding:12px 14px; border-radius:14px; border:1px solid var(--line); font-weight:700; min-height:74px;
        svg{ font-size:20px; }
        .lbl{ letter-spacing:.02em; color:var(--text); opacity:.9; }
        .pill{
          font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
          font-size:22px; font-weight:800; background:#eef4ff; border:1px solid #d9e6ff;
          padding:8px 14px; border-radius:12px; color:var(--text);
        }
        &.square{
          min-width:280px; min-height:110px; border-radius:16px;
          grid-auto-flow:row; align-content:center; justify-items:center; text-align:center;
          .lbl{ font-size:13px; }
          .pill{ font-size:26px; padding:10px 16px; }
        }
      }
      .chip--hint{ background:linear-gradient(180deg,#fff6e9,#fff0db); border-color:#ffe0b3; svg{color:var(--warn);} }
      .chip--selected{ background:linear-gradient(180deg,#eaf1ff,#e3eeff); border-color:#cfe0ff; svg{color:var(--brand);} }
      @media (max-width:640px){ .chips{ padding:10px 12px; } }
    }

    .multi-grid{
      display:grid; gap:12px; grid-template-columns:repeat(2, minmax(0,1fr));
      @media (max-width:980px){ grid-template-columns:1fr; }
    }
    .multi-item{
      background:#f7fbff; border:1px solid var(--line); border-radius:12px; padding:12px;
      display:grid; gap:8px;
      label{ font-size:12px; color:#64748b; font-weight:800; }
      input[type="text"]{
        height:44px; border-radius:10px; border:1px solid var(--line); background:#fff; padding:10px 12px;
        outline:none; transition:border-color .18s ease, box-shadow .18s ease;
      }
      input[type="text"]:focus{ border-color:var(--brand); box-shadow:var(--ring); }
      .multi-select{ margin-top:6px; }
    }

    .multiple-foot{
      display:flex; justify-content:flex-end; gap:10px; padding-top:10px; margin-top:6px; border-top:1px solid var(--line);
      .btn-primary{ min-width:220px; }
      @media (max-width:560px){ flex-direction:column; align-items:stretch;
        .btn-primary{ width:100%; } .btn-secondary{ width:100%; justify-content:center; }
      }
    }
  }

  /* =========================================================
     REJILLA DE UBICACIONES
     ========================================================= */
  .panel.rejilla{
    .estantes-grid{ display:grid; gap: 12px; }

    /* Clamps automáticos según viewport (evita overflow) */
    @media (min-width:1401px){ .estantes-grid{ grid-template-columns: repeat(5, minmax(0,1fr)) !important; } }
    @media (max-width:1400px){ .estantes-grid{ grid-template-columns: repeat(4, minmax(0,1fr)) !important; } }
    @media (max-width:1200px){ .estantes-grid{ grid-template-columns: repeat(3, minmax(0,1fr)) !important; } }
    @media (max-width:980px){  .estantes-grid{ grid-template-columns: repeat(2, minmax(0,1fr)) !important; } }
    @media (max-width:640px){  .estantes-grid{ grid-template-columns: 1fr !important; } }

    .balda{
      position:relative; background:#f7fbff; border:1px solid var(--line); color:var(--text);
      padding:12px; border-radius:12px; text-align:left; cursor:pointer;
      transition:transform .06s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
      box-shadow:0 0 0 0 transparent; min-height:92px; display:grid; align-content:center; gap:8px;
      &:hover{ transform:translateY(-1px); border-color:#cfe0ff; background:#fff; }
      &:focus-visible{ outline:none; box-shadow:var(--ring); }
      .balda-header{ font-weight:800; letter-spacing:.02em; font-size:15px; }
      .balda-badge{
        display:inline-flex; align-items:center; gap:6px;
        padding:6px 10px; border-radius:8px; background:#eef4ff; color:#4b5a78; font-size:12px; border:1px solid #dfe8ff;
      }
    }

    .balda.verde{ background:#f4fff7; border-left:4px solid var(--ok); }
    .balda.naranja{ background:#fff9f1; border-left:4px solid var(--warn); }
    .balda.rojo{ background:#fff5f5; border-left:4px solid var(--danger); }

    .activa{
      border-color:var(--brand); background:#fff;
      box-shadow:0 0 0 2px #e8f0ff, 0 0 0 6px var(--brand-ring); position:relative;
    }

    .balda.is-suggested::after,
    .balda.is-related::after,
    .balda.is-activePulse::after{
      content:''; position:absolute; inset:-4px; border-radius:12px;
      box-shadow:0 0 .75rem rgba(37,99,235,.55);
      animation:pulseGlowX 1.4s ease-in-out infinite; pointer-events:none;
    }

    .leyenda{
      margin-top:8px; color:var(--muted); font-size:12px;
      display:flex; gap:16px; align-items:center; flex-wrap:wrap;
      .dot{ width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:6px; }
      .dot.verde{ background:var(--ok); } .dot.naranja{ background:var(--warn); } .dot.rojo{ background:var(--danger); }
    }
  }

  /* ===== Modal éxito ===== */
  .modal-exito{
    position:fixed; inset:0; display:grid; place-items:center; z-index:50;
    background:radial-gradient(360px 200px at 50% 20%, rgba(22,163,74,.08), transparent 70%); pointer-events:none;
    .contenido{
      pointer-events:auto; display:flex; align-items:center; gap:12px; background:#fff;
      border:1px solid rgba(22,163,74,.35); color:#064e3b; border-radius:16px; padding:16px 18px;
      box-shadow:0 12px 40px rgba(13,34,79,.18), 0 0 0 6px rgba(34,197,94,.10);
      transform:translateY(-6px) scale(.98); animation:popIn .16s ease forwards;
      svg{ color:#16a34a; font-size:22px; }
      h3{ margin:0; font-size:16px; font-weight:800; } p{ margin:0; color:#0f5132; }
    }
  }
  .modal-exito--giant .contenido{ padding:18px 20px; h3{ font-size:18px; } }

  /* ===== Animación vuelo paquetito ===== */
  #fly-layer{ position:fixed; inset:0; pointer-events:none; z-index:60; }
  .fly-parcel{
    position:fixed; width:34px; height:34px;
    left:var(--sx,0px); top:var(--sy,0px); transform:translate(-50%,-50%);
    background:var(--brand); border-radius:10px; display:grid; place-items:center;
    box-shadow:0 8px 24px rgba(37,99,235,.28), 0 0 0 5px rgba(37,99,235,.16); opacity:.98;
    .icon{display:grid; place-items:center;} svg{ fill:#fff; }
  }
  .fly-parcel.animate{ animation:fly 1.15s cubic-bezier(.22,.8,.25,1) forwards; }

  /* ===== Alertas ===== */
  .alerta{
    margin-top:10px; display:flex; gap:10px; align-items:flex-start;
    border:1px solid var(--line); padding:10px 12px; border-radius:12px;
    &.info{ background:#eef4ff; border-color:#dbe7ff; }
    &.warning{ background:#fff4e6; border-color:#ffe0b3; }
    svg{ margin-top:3px; }
    b{ display:block; } p{ margin:2px 0 0; color:var(--muted); }
  }
  .alert.warn{
    margin:4px 0 0; background:#fff4e6; border:1px solid #ffe0b3; color:#7a4b00; padding:10px 12px; border-radius:12px;
    box-shadow:0 4px 14px rgba(122,75,0,.06); font-weight:700; font-size:13px;
  }
}

/* ===== Animaciones ===== */
@keyframes shimmer{ 0%{background-position:-120% 0;} 100%{background-position:120% 0;} }
@keyframes popIn{ from{ transform:translateY(-6px) scale(.98); opacity:0; } to{ transform:translateY(0) scale(1); opacity:1; } }

@keyframes pulseGlowX{
  0%,100%{ box-shadow:0 0 0 2px #e8f0ff, 0 0 0 6px var(--brand-ring); }
  50%{ box-shadow:0 0 0 4px #dce7ff, 0 0 0 10px rgba(37,99,235,.28); }
}

@keyframes fadeInUp{ from{ opacity:0; transform:translateY(4px); } to{ opacity:1; transform:translateY(0); } }

@keyframes fly{
  0%{ transform:translate(calc(var(--sx)*1px), calc(var(--sy)*1px)) scale(1); opacity:.98; filter:brightness(1); }
  15%{ transform:translate(calc(var(--sx)*1px), calc(var(--sy)*1px - 30px)) scale(1.06) rotate(-6deg); }
  45%{
    transform:translate(
      calc( (var(--sx) + (var(--ex) - var(--sx)) * .45) * 1px ),
      calc( (var(--sy) + (var(--ey) - var(--sy)) * .45 - 90) * 1px )
    ) scale(1.02) rotate(4deg);
  }
  80%{
    transform:translate(
      calc( (var(--sx) + (var(--ex) - var(--sx)) * .86) * 1px ),
      calc( (var(--sy) + (var(--ey) - var(--sy)) * .86 - 16) * 1px )
    ) scale(.96) rotate(2deg);
    filter:brightness(1.02);
  }
  100%{ transform:translate(calc(var(--ex)*1px), calc(var(--ey)*1px)) scale(.9); opacity:0; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ animation-duration:.01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
}

/* Helpers */
.muted{ color:var(--muted) !important; }
