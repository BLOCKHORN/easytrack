/* src/components/HowItWorks.scss */
/* Scope total al componente para evitar interferencias globales */
.ep-hiw{
  --ep-hiw-text: var(--ld-text, #0f172a);
  --ep-hiw-muted: #64748b;
  --ep-hiw-surface: var(--ld-surface, #fff);
  --ep-hiw-primary-rgb: var(--primary-rgb, 79,70,229);

  position: relative; z-index: 1;
  padding: clamp(44px, 7vw, 84px) clamp(20px, 5vw, 72px);
  background: linear-gradient(180deg, rgba(255,255,255,.7), rgba(255,255,255,.95));

  &__head{
    text-align:center; margin:0 0 22px;
    h2{
      font-size:clamp(1.8rem,3.2vw,2.3rem);
      font-weight:900; margin:0 0 6px; color:var(--ep-hiw-text);
      letter-spacing: -.02em;
    }
    p{ color:var(--ep-hiw-muted); margin:0; }
  }

  /* ====== Layout ====== */
  &__grid{
    display:grid; grid-template-columns: 1.05fr 0.95fr; gap:22px; max-width:1100px; margin:0 auto;
    @media (max-width: 1100px){ gap:18px; }
    @media (max-width: 980px){ grid-template-columns:1fr; }
  }

  /* ====== Timeline ====== */
  &__timeline{ list-style:none; padding:0; margin:0; position:relative; }
  &__step{
    position:relative; padding-left:58px; margin-bottom:20px;
    &:last-child{ margin-bottom:0; }

    .ep-hiw__dot{
      position:absolute; left:0; top:2px;
      width:40px; height:40px; border-radius:999px; display:grid; place-items:center;
      font-weight:900; color:var(--ep-hiw-text); background:#fff;
      border:2px solid rgba(var(--ep-hiw-primary-rgb), .28);
      box-shadow:
        0 10px 22px rgba(var(--ep-hiw-primary-rgb), .16),
        inset 0 0 0 6px rgba(var(--ep-hiw-primary-rgb), .06);
    }

    &::before{
      content:""; position:absolute; left:20px; top:42px; bottom:-20px; width:2px;
      background:linear-gradient(180deg, rgba(var(--ep-hiw-primary-rgb), .28), rgba(2,6,23,.08));
    }
    &:last-child::before{ display:none; }

    .ep-hiw__content{
      background: var(--ep-hiw-surface);
      border:1px solid rgba(2,6,23,.06);
      border-radius:16px;
      padding:16px;
      box-shadow:0 12px 28px rgba(2,6,23,.06);
    }
  }

  /* Encabezado de cada paso */
  &__step-head{
    display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:wrap;
    h3{ margin:0; font-size:1.12rem; color:var(--ep-hiw-text); font-weight:900; letter-spacing:.2px; }
  }
  &__time{
    display:inline-flex; gap:6px; align-items:center;
    color:var(--ep-hiw-text); font-weight:800; font-size:.95rem;
    padding:6px 10px; border-radius:999px;
    background:#f3f4ff; border:1px solid #dfe2ff;
  }

  /* Lista de tareas */
  &__tasks{
    margin:10px 0; padding:0; list-style:none; display:grid; gap:8px;
    li{ display:flex; align-items:center; gap:10px; color:var(--ep-hiw-text); }
    svg{ opacity:.9; }
  }

  /* Nota / tip */
  &__tip{
    font-size:13px; color:var(--ep-hiw-text);
    background:#ecfeff; border:1px solid #a5f3fc;
    padding:10px 12px; border-radius:10px; margin-top:6px;
  }

  /* Botones inline */
  &__actions{
    display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;
    .ep-hiw__btn{ min-width: 160px; justify-content: center; }
  }
  &__btn{
    display:inline-flex; align-items:center; gap:8px; font-weight:800;
    border-radius:10px; padding:10px 14px; cursor:pointer;
    border:1px solid #e5e7eb; background:#fff; color:var(--ep-hiw-text);
    transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;
    text-decoration: none; /* por si alguna vez es Link */
    &:hover{ transform:translateY(-1px); box-shadow:0 10px 20px rgba(2,6,23,.08); }
    &:active{ transform: translateY(0); }
    &:focus-visible{ outline:2px solid rgba(var(--ep-hiw-primary-rgb), .5); outline-offset:2px; }
  }
  &__btn--primary{
    background:rgb(var(--ep-hiw-primary-rgb)); color:#fff; border-color:rgba(15,23,42,.08);
  }
  &__btn--ghost{
    color:rgb(var(--ep-hiw-primary-rgb)); border-color:rgba(var(--ep-hiw-primary-rgb), .3); background:#fff;
  }

  /* ====== Panel asistente ====== */
  &__preview{ min-width:0; }
  &__assistant{
    background: linear-gradient(180deg, rgba(var(--ep-hiw-primary-rgb), .06), #fff);
    border:1px solid rgba(var(--ep-hiw-primary-rgb), .25);
    border-radius:16px; box-shadow:0 24px 42px rgba(var(--ep-hiw-primary-rgb), .14);
    overflow:hidden;
  }
  &__assistant-head{
    padding:12px 14px; font-weight:900; color:var(--ep-hiw-text);
    display:flex; align-items:center; gap:8px;
    background: rgba(255,255,255,.78);
    border-bottom:1px solid rgba(var(--ep-hiw-primary-rgb), .2);
    backdrop-filter: blur(4px);
  }
  &__assistant-body{ padding:14px; display:grid; gap:10px; }

  &__row{
    display:flex; justify-content:space-between; gap:8px; align-items:center;
    padding:10px 12px; background:#fff;
    border:1px solid rgba(15,23,42,.08); border-radius:10px;
  }
  &__k{ color:#64748b; font-size:13px; }
  &__v{ color:var(--ep-hiw-text); font-weight:800; display:inline-flex; align-items:center; gap:8px; }

  &__divider{ height:1px; background: rgba(var(--ep-hiw-primary-rgb), .25); margin:4px 0 2px; }

  &__progress{ list-style:none; padding:0; margin:0; display:grid; gap:8px; }

  &__state{
    padding:10px 12px; border-radius:10px; font-weight:800; color:var(--ep-hiw-text); border:1px solid #e5e7eb; background:#fff;
    display:flex; align-items:center; gap:8px;
    &--done{ background:#f0fdf4; border-color:#bbf7d0; color:#14532d; }
    &--current{ background:#eef2ff; border-color:#c7d2fe; color:#1e1b4b; }
    &--next{ background:#fff; }
  }

  /* ====== Animaciones sutiles ====== */
  &__reveal{ opacity:0; transform: translateY(8px); animation: ep-hiw-slideUp .5s ease forwards; }
  &__timeline > .ep-hiw__step.ep-hiw__reveal:nth-child(2){ animation-delay:.06s; }
  &__timeline > .ep-hiw__step.ep-hiw__reveal:nth-child(3){ animation-delay:.12s; }

  @keyframes ep-hiw-slideUp{ to{ opacity:1; transform:none; } }

  @media (prefers-reduced-motion: reduce){
    &__reveal{ opacity:1; transform:none; animation:none; }
  }

  /* ====== Responsive ====== */
  @media (max-width: 720px){
    &__step{ padding-left:52px; }
    &__dot{ width:36px; height:36px; left:2px; }
    &__step-head h3{ font-size:1.05rem; }
    &__time{ font-size:.9rem; padding:6px 10px; }
    &__actions .ep-hiw__btn{ padding:9px 12px; min-width: 0; flex:1; }
  }

  @media (max-width: 520px){
    &__step{ padding-left:0; }
    &__step .ep-hiw__dot{ position:relative; left:auto; top:auto; margin-bottom:8px; }
    &__step::before{ display:none; }
    .ep-hiw__content{ border-radius:14px; }
    .ep-hiw__assistant{ border-radius:14px; }
  }
}
